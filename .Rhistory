lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
legend("top", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"))
range(abund)
for(i in 1:(years-1)){
j.a[i+1]=j.a[i]+((ya*a.a[i])/(xa*a.a[i]))-mortA*j.a[i]-matA*j.a[i]-((ea*j.a[i]/(1+ea*ha*j.a[i]))*a.a[i])
j.b[i+1]=j.b[i]+((yb*a.b[i])/(xb*a.b[i]))-mortB*j.b[i]-matB*j.b[i]-((eb*j.b[i]/(1+eb*hb*j.b[i]))*a.b[i])
a.a[i+1]=a.a[i]+matA*j.a[i]-mortA*a.a[i]-(qa*Ea*a.a[i]*harvA)
a.b[i+1]=a.b[i]+matB*j.b[i]-mortB*a.b[i]-(qb*Eb*a.b[i]*harvB)
}
abund=data.frame(j.a, j.b, a.a, a.b)
#looking at output
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = range(abund))
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
for(i in 1:(years-1)){
j.a[i+1]=j.a[i]+((ya*a.a[i])/(xa+a.a[i]))-mortA*j.a[i]-matA*j.a[i]-((ea*j.a[i]/(1+ea*ha*j.a[i]))*a.a[i])
j.b[i+1]=j.b[i]+((yb*a.b[i])/(xb+a.b[i]))-mortB*j.b[i]-matB*j.b[i]-((eb*j.b[i]/(1+eb*hb*j.b[i]))*a.b[i])
a.a[i+1]=a.a[i]+matA*j.a[i]-mortA*a.a[i]-(qa*Ea*a.a[i]*harvA)
a.b[i+1]=a.b[i]+matB*j.b[i]-mortB*a.b[i]-(qb*Eb*a.b[i]*harvB)
}
abund=data.frame(j.a, j.b, a.a, a.b)
#looking at output
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = range(abund))
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
#places to store model output
years=500
a.a=numeric(years)
j.a=numeric(years)
a.b=numeric(years)
j.b=numeric(years)
#natural mortality of each species
mortA=0.15
mortB=0.15
#maturation of each species
matA=0.2
matB=0.2
#beverton-holt recruitment parameters for each species
xa=100 #stock size at which recruitment = half the max
xb=100 #stock size at which recruitment = half the max
ya=100 #maximum recruits
yb=100 #maximum recruits
#predation parameters for each species
ha=50 #handle time
hb=50 #handle time
ea=0.1 #encounter rate
eb=0.1 #encounter rate
#harvest parameters
qa=0.1 #catchability of A
qb=0.1 #catchability of B
Ea=1 #effort for A
Eb=1 #effort for B
harvA=c(rep(0.75, years/2), rep(0.05, years/2)) #harvest rate for A
harvB=0.05 #harvest rate for B
#initializing
start=c(30,30,30,30)
a.a[1]=start[1]
j.a[1]=start[2]
a.b[1]=start[3]
j.b[1]=start[4]
for(i in 1:(years-1)){
j.a[i+1]=j.a[i]+((ya*a.a[i])/(xa+a.a[i]))-mortA*j.a[i]-matA*j.a[i]-((ea*j.a[i]/(1+ea*ha*j.a[i]))*a.a[i])
j.b[i+1]=j.b[i]+((yb*a.b[i])/(xb+a.b[i]))-mortB*j.b[i]-matB*j.b[i]-((eb*j.b[i]/(1+eb*hb*j.b[i]))*a.b[i])
a.a[i+1]=a.a[i]+matA*j.a[i]-mortA*a.a[i]-(qa*Ea*a.a[i]*harvA[i])
a.b[i+1]=a.b[i]+matB*j.b[i]-mortB*a.b[i]-(qb*Eb*a.b[i]*harvB)
}
abund=data.frame(j.a, j.b, a.a, a.b)
#looking at output
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = range(abund))
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
years=500
a.a=numeric(years)
j.a=numeric(years)
a.b=numeric(years)
j.b=numeric(years)
#natural mortality of each species
mortA=0.15
mortB=0.15
#maturation of each species
matA=0.2
matB=0.2
#beverton-holt recruitment parameters for each species
xa=100 #stock size at which recruitment = half the max
xb=100 #stock size at which recruitment = half the max
ya=100 #maximum recruits
yb=100 #maximum recruits
#predation parameters for each species
ha=50 #handle time
hb=50 #handle time
ea=0.5 #encounter rate for a juveniles with adults of b
eb=0.1 #encounter rate for b juveniles with adults of a
#harvest parameters
qa=0.1 #catchability of A
qb=0.1 #catchability of B
Ea=1 #effort for A
Eb=1 #effort for B
harvA=c(rep(0.75, years/2), rep(0.05, years/2)) #harvest rate for A
harvB=0.05 #harvest rate for B
#initializing
start=c(30,30,30,30)
a.a[1]=start[1]
j.a[1]=start[2]
a.b[1]=start[3]
j.b[1]=start[4]
for(i in 1:(years-1)){
j.a[i+1]=j.a[i]+((ya*a.a[i])/(xa+a.a[i]))-mortA*j.a[i]-matA*j.a[i]-((ea*j.a[i]/(1+ea*ha*j.a[i]))*a.a[i])
j.b[i+1]=j.b[i]+((yb*a.b[i])/(xb+a.b[i]))-mortB*j.b[i]-matB*j.b[i]-((eb*j.b[i]/(1+eb*hb*j.b[i]))*a.b[i])
a.a[i+1]=a.a[i]+matA*j.a[i]-mortA*a.a[i]-(qa*Ea*a.a[i]*harvA[i])
a.b[i+1]=a.b[i]+matB*j.b[i]-mortB*a.b[i]-(qb*Eb*a.b[i]*harvB)
}
abund=data.frame(j.a, j.b, a.a, a.b)
#looking at output
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = range(abund))
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
years=500
a.a=numeric(years)
j.a=numeric(years)
a.b=numeric(years)
j.b=numeric(years)
#natural mortality of each species
mortA=0.15
mortB=0.15
#maturation of each species
matA=0.2
matB=0.2
#beverton-holt recruitment parameters for each species
xa=100 #stock size at which recruitment = half the max
xb=100 #stock size at which recruitment = half the max
ya=100 #maximum recruits
yb=100 #maximum recruits
#predation parameters for each species
ha=10 #handle time
hb=50 #handle time
ea=0.5 #encounter rate for a juveniles with adults of b
eb=0.1 #encounter rate for b juveniles with adults of a
#harvest parameters
qa=0.1 #catchability of A
qb=0.1 #catchability of B
Ea=1 #effort for A
Eb=1 #effort for B
harvA=c(rep(0.75, years/2), rep(0.05, years/2)) #harvest rate for A
harvB=0.05 #harvest rate for B
#initializing
start=c(30,30,30,30)
a.a[1]=start[1]
j.a[1]=start[2]
a.b[1]=start[3]
j.b[1]=start[4]
for(i in 1:(years-1)){
j.a[i+1]=j.a[i]+((ya*a.a[i])/(xa+a.a[i]))-mortA*j.a[i]-matA*j.a[i]-((ea*j.a[i]/(1+ea*ha*j.a[i]))*a.a[i])
j.b[i+1]=j.b[i]+((yb*a.b[i])/(xb+a.b[i]))-mortB*j.b[i]-matB*j.b[i]-((eb*j.b[i]/(1+eb*hb*j.b[i]))*a.b[i])
a.a[i+1]=a.a[i]+matA*j.a[i]-mortA*a.a[i]-(qa*Ea*a.a[i]*harvA[i])
a.b[i+1]=a.b[i]+matB*j.b[i]-mortB*a.b[i]-(qb*Eb*a.b[i]*harvB)
}
abund=data.frame(j.a, j.b, a.a, a.b)
#looking at output
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = range(abund))
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
#looking at output
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = range(abund), ylab = "abundance", xlab = "time")
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
legend("top", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"))
legend("bottomleft", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"))
legend("bottomright", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"))
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = range(abund), ylab = "abundance", xlab = "time")
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
legend("bottomright", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"))
#looking at output
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = c(0,range(abund), ylab = "abundance", xlab = "time")
)
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = c(0,range(abund)), ylab = "abundance", xlab = "time")
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = c(0,range(abund)), ylab = "abundance", xlab = "time")
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
legend("bottomright", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"))
range(abund)
max(abund)
#looking at output
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = c(0,max(abund)), ylab = "abundance", xlab = "time")
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
legend("bottomright", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"))
abline(v=years/2)
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = c(0,max(abund)), ylab = "abundance", xlab = "time")
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
abline(v=years/2, col = "grey")
legend("bottomright", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"))
legend("bottomright", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"), bty = "n")
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = c(0,max(abund)), ylab = "abundance", xlab = "time")
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
abline(v=years/2, col = "grey")
legend("bottomright", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"), bty = "n")
years=500
a.a=numeric(years)
j.a=numeric(years)
a.b=numeric(years)
j.b=numeric(years)
#natural mortality of each species
mortA=0.15
mortB=0.15
#maturation of each species
matA=0.2
matB=0.2
#beverton-holt recruitment parameters for each species
xa=100 #stock size at which recruitment = half the max
xb=100 #stock size at which recruitment = half the max
ya=100 #maximum recruits
yb=100 #maximum recruits
#predation parameters for each species
ha=10 #handle time
hb=50 #handle time
ea=0.1 #encounter rate for a juveniles with adults of b
eb=0.1 #encounter rate for b juveniles with adults of a
#harvest parameters
qa=0.1 #catchability of A
qb=0.1 #catchability of B
Ea=1 #effort for A
Eb=1 #effort for B
harvA=c(rep(0.75, years/2), rep(0.05, years/2)) #harvest rate for A
harvB=0.05 #harvest rate for B
#initializing
start=c(30,30,30,30)
a.a[1]=start[1]
j.a[1]=start[2]
a.b[1]=start[3]
j.b[1]=start[4]
for(i in 1:(years-1)){
j.a[i+1]=j.a[i]+((ya*a.a[i])/(xa+a.a[i]))-mortA*j.a[i]-matA*j.a[i]-((ea*j.a[i]/(1+ea*ha*j.a[i]))*a.a[i])
j.b[i+1]=j.b[i]+((yb*a.b[i])/(xb+a.b[i]))-mortB*j.b[i]-matB*j.b[i]-((eb*j.b[i]/(1+eb*hb*j.b[i]))*a.b[i])
a.a[i+1]=a.a[i]+matA*j.a[i]-mortA*a.a[i]-(qa*Ea*a.a[i]*harvA[i])
a.b[i+1]=a.b[i]+matB*j.b[i]-mortB*a.b[i]-(qb*Eb*a.b[i]*harvB)
}
abund=data.frame(j.a, j.b, a.a, a.b)
#looking at output
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = c(0,max(abund)), ylab = "abundance", xlab = "time")
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
abline(v=years/2, col = "grey")
legend("bottomright", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"), bty = "n")
years=500
a.a=numeric(years)
j.a=numeric(years)
a.b=numeric(years)
j.b=numeric(years)
#natural mortality of each species
mortA=0.15
mortB=0.15
#maturation of each species
matA=0.2
matB=0.2
#beverton-holt recruitment parameters for each species
xa=100 #stock size at which recruitment = half the max
xb=100 #stock size at which recruitment = half the max
ya=100 #maximum recruits
yb=100 #maximum recruits
#predation parameters for each species
ha=40 #handle time
hb=50 #handle time
ea=0.1 #encounter rate for a juveniles with adults of b
eb=0.1 #encounter rate for b juveniles with adults of a
#harvest parameters
qa=0.1 #catchability of A
qb=0.1 #catchability of B
Ea=1 #effort for A
Eb=1 #effort for B
harvA=c(rep(0.75, years/2), rep(0.05, years/2)) #harvest rate for A
harvB=0.05 #harvest rate for B
#initializing
start=c(30,30,30,30)
a.a[1]=start[1]
j.a[1]=start[2]
a.b[1]=start[3]
j.b[1]=start[4]
for(i in 1:(years-1)){
j.a[i+1]=j.a[i]+((ya*a.a[i])/(xa+a.a[i]))-mortA*j.a[i]-matA*j.a[i]-((ea*j.a[i]/(1+ea*ha*j.a[i]))*a.a[i])
j.b[i+1]=j.b[i]+((yb*a.b[i])/(xb+a.b[i]))-mortB*j.b[i]-matB*j.b[i]-((eb*j.b[i]/(1+eb*hb*j.b[i]))*a.b[i])
a.a[i+1]=a.a[i]+matA*j.a[i]-mortA*a.a[i]-(qa*Ea*a.a[i]*harvA[i])
a.b[i+1]=a.b[i]+matB*j.b[i]-mortB*a.b[i]-(qb*Eb*a.b[i]*harvB)
}
abund=data.frame(j.a, j.b, a.a, a.b)
#looking at output
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = c(0,max(abund)), ylab = "abundance", xlab = "time")
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
abline(v=years/2, col = "grey")
legend("bottomright", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"), bty = "n")
#places to store model output
years=500
a.a=numeric(years)
j.a=numeric(years)
a.b=numeric(years)
j.b=numeric(years)
#natural mortality of each species
mortA=0.15
mortB=0.15
#maturation of each species
matA=0.2
matB=0.2
#beverton-holt recruitment parameters for each species
xa=100 #stock size at which recruitment = half the max
xb=100 #stock size at which recruitment = half the max
ya=100 #maximum recruits
yb=100 #maximum recruits
#predation parameters for each species
ha=40 #handle time
hb=50 #handle time
ea=0.1 #encounter rate for a juveniles with adults of b
eb=0.1 #encounter rate for b juveniles with adults of a
#harvest parameters
qa=0.1 #catchability of A
qb=0.1 #catchability of B
Ea=1 #effort for A
Eb=1 #effort for B
harvA=c(rep(0.75, years/2), rep(0.75, years/2)) #harvest rate for A
harvB=c(rep(0.75, years/2), rep(0.05, years/2)) #harvest rate for B
#initializing
start=c(30,30,30,30)
a.a[1]=start[1]
j.a[1]=start[2]
a.b[1]=start[3]
j.b[1]=start[4]
for(i in 1:(years-1)){
j.a[i+1]=j.a[i]+((ya*a.a[i])/(xa+a.a[i]))-mortA*j.a[i]-matA*j.a[i]-((ea*j.a[i]/(1+ea*ha*j.a[i]))*a.a[i])
j.b[i+1]=j.b[i]+((yb*a.b[i])/(xb+a.b[i]))-mortB*j.b[i]-matB*j.b[i]-((eb*j.b[i]/(1+eb*hb*j.b[i]))*a.b[i])
a.a[i+1]=a.a[i]+matA*j.a[i]-mortA*a.a[i]-(qa*Ea*a.a[i]*harvA[i])
a.b[i+1]=a.b[i]+matB*j.b[i]-mortB*a.b[i]-(qb*Eb*a.b[i]*harvB[i])
}
abund=data.frame(j.a, j.b, a.a, a.b)
#looking at output
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = c(0,max(abund)), ylab = "abundance", xlab = "time")
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
abline(v=years/2, col = "grey")
legend("bottomright", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"), bty = "n")
#places to store model output
years=500
a.a=numeric(years)
j.a=numeric(years)
a.b=numeric(years)
j.b=numeric(years)
#natural mortality of each species
mortA=0.15
mortB=0.15
#maturation of each species
matA=0.2
matB=0.2
#beverton-holt recruitment parameters for each species
xa=100 #stock size at which recruitment = half the max
xb=100 #stock size at which recruitment = half the max
ya=100 #maximum recruits
yb=100 #maximum recruits
#predation parameters for each species
ha=40 #handle time
hb=50 #handle time
ea=0.1 #encounter rate for a juveniles with adults of b
eb=0.1 #encounter rate for b juveniles with adults of a
#harvest parameters
qa=0.1 #catchability of A
qb=0.1 #catchability of B
Ea=1 #effort for A
Eb=1 #effort for B
harvA=c(rep(0.05, years/2), rep(0.05, years/2)) #harvest rate for A
harvB=c(rep(0.05, years/2), rep(0.05, years/2)) #harvest rate for B
#initializing
start=c(30,30,30,30)
a.a[1]=start[1]
j.a[1]=start[2]
a.b[1]=start[3]
j.b[1]=start[4]
for(i in 1:(years-1)){
j.a[i+1]=j.a[i]+((ya*a.a[i])/(xa+a.a[i]))-mortA*j.a[i]-matA*j.a[i]-((ea*j.a[i]/(1+ea*ha*j.a[i]))*a.a[i])
j.b[i+1]=j.b[i]+((yb*a.b[i])/(xb+a.b[i]))-mortB*j.b[i]-matB*j.b[i]-((eb*j.b[i]/(1+eb*hb*j.b[i]))*a.b[i])
a.a[i+1]=a.a[i]+matA*j.a[i]-mortA*a.a[i]-(qa*Ea*a.a[i]*harvA[i])
a.b[i+1]=a.b[i]+matB*j.b[i]-mortB*a.b[i]-(qb*Eb*a.b[i]*harvB[i])
}
abund=data.frame(j.a, j.b, a.a, a.b)
#looking at output
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = c(0,max(abund)), ylab = "abundance", xlab = "time")
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
abline(v=years/2, col = "grey")
legend("bottomright", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"), bty = "n")
#places to store model output
years=500
a.a=numeric(years)
j.a=numeric(years)
a.b=numeric(years)
j.b=numeric(years)
#natural mortality of each species
mortA=0.15
mortB=0.15
#maturation of each species
matA=0.2
matB=0.2
#beverton-holt recruitment parameters for each species
xa=100 #stock size at which recruitment = half the max
xb=100 #stock size at which recruitment = half the max
ya=100 #maximum recruits
yb=100 #maximum recruits
#predation parameters for each species
ha=10 #handle time
hb=50 #handle time
ea=0.1 #encounter rate for a juveniles with adults of b
eb=0.1 #encounter rate for b juveniles with adults of a
#harvest parameters
qa=0.1 #catchability of A
qb=0.1 #catchability of B
Ea=1 #effort for A
Eb=1 #effort for B
harvA=c(rep(0.05, years/2), rep(0.05, years/2)) #harvest rate for A
harvB=c(rep(0.05, years/2), rep(0.05, years/2)) #harvest rate for B
#initializing
start=c(30,30,30,30)
a.a[1]=start[1]
j.a[1]=start[2]
a.b[1]=start[3]
j.b[1]=start[4]
for(i in 1:(years-1)){
j.a[i+1]=j.a[i]+((ya*a.a[i])/(xa+a.a[i]))-mortA*j.a[i]-matA*j.a[i]-((ea*j.a[i]/(1+ea*ha*j.a[i]))*a.a[i])
j.b[i+1]=j.b[i]+((yb*a.b[i])/(xb+a.b[i]))-mortB*j.b[i]-matB*j.b[i]-((eb*j.b[i]/(1+eb*hb*j.b[i]))*a.b[i])
a.a[i+1]=a.a[i]+matA*j.a[i]-mortA*a.a[i]-(qa*Ea*a.a[i]*harvA[i])
a.b[i+1]=a.b[i]+matB*j.b[i]-mortB*a.b[i]-(qb*Eb*a.b[i]*harvB[i])
}
abund=data.frame(j.a, j.b, a.a, a.b)
#looking at output
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = c(0,max(abund)), ylab = "abundance", xlab = "time")
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
abline(v=years/2, col = "grey")
legend("bottomright", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"), bty = "n")
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = c(0,max(abund)), ylab = "abundance", xlab = "time")
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
#abline(v=years/2, col = "grey")
legend("bottomright", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"), bty = "n")
#places to store model output
years=500
a.a=numeric(years)
j.a=numeric(years)
a.b=numeric(years)
j.b=numeric(years)
#natural mortality of each species
mortA=0.15
mortB=0.15
#maturation of each species
matA=0.2
matB=0.2
#beverton-holt recruitment parameters for each species
xa=100 #stock size at which recruitment = half the max
xb=100 #stock size at which recruitment = half the max
ya=100 #maximum recruits
yb=100 #maximum recruits
#predation parameters for each species
ha=50 #handle time
hb=50 #handle time
ea=0.1 #encounter rate for a juveniles with adults of b
eb=0.1 #encounter rate for b juveniles with adults of a
#harvest parameters
qa=0.1 #catchability of A
qb=0.1 #catchability of B
Ea=1 #effort for A
Eb=1 #effort for B
harvA=c(rep(0.05, years/2), rep(0.05, years/2)) #harvest rate for A
harvB=c(rep(0.05, years/2), rep(0.05, years/2)) #harvest rate for B
#initializing
start=c(30,30,30,30)
a.a[1]=start[1]
j.a[1]=start[2]
a.b[1]=start[3]
j.b[1]=start[4]
for(i in 1:(years-1)){
j.a[i+1]=j.a[i]+((ya*a.a[i])/(xa+a.a[i]))-mortA*j.a[i]-matA*j.a[i]-((ea*j.a[i]/(1+ea*ha*j.a[i]))*a.a[i])
j.b[i+1]=j.b[i]+((yb*a.b[i])/(xb+a.b[i]))-mortB*j.b[i]-matB*j.b[i]-((eb*j.b[i]/(1+eb*hb*j.b[i]))*a.b[i])
a.a[i+1]=a.a[i]+matA*j.a[i]-mortA*a.a[i]-(qa*Ea*a.a[i]*harvA[i])
a.b[i+1]=a.b[i]+matB*j.b[i]-mortB*a.b[i]-(qb*Eb*a.b[i]*harvB[i])
}
abund=data.frame(j.a, j.b, a.a, a.b)
#looking at output
plot(1:years, abund$j.a, type = "l", lty = 3, ylim = c(0,max(abund)), ylab = "abundance", xlab = "time")
lines(1:years, abund$j.b, lty = 3, col = "red")
lines(1:years, abund$a.a, lty = 1, col = "black")
lines(1:years, abund$a.b, lty = 1, col = "red")
#abline(v=years/2, col = "grey")
legend("bottomright", legend = c("j.a", "j.b", "a.a", "a.b"), lty = c(3,3,1,1), col = c("black", "red", "black", "red"), bty = "n")
